# Анализ Расхождений: Проект Code2MARKDOWN

## Введение

Этот документ детализирует расхождения между заявленными целями и стандартами качества проекта Code2MARKDOWN и его фактическим состоянием на момент анализа. Цель документа — создать единую отправную точку для дальнейшей разработки и приведения проекта в полное соответствие с внутренними руководствами.

## 1. Критическое Несоответствие в Конфигурации Pre-commit Хуков [RESOLVED]

### Проблема
Основная система автоматического контроля качества частично неработоспособна.

### Детали
- **Ожидание:** Файл `.pre-commit-config.yaml` должен ссылаться на актуальные и существующие скрипты для проверки качества кода перед каждым коммитом, как того требует `01-quality-guideline.md`.
- **Реальность:** Конфигурация pre-commit ссылается на скрипт `scripts/development/check_circular_imports.py`. Однако, согласно отчету `DEAD_CODE_CLEANUP_REPORT.md`, этот скрипт был признан устаревшим и перемещен в архив (`scripts/development/archive/`).
- **Влияние:** **Автоматическая проверка на циклические импорты не работает.** Любая попытка выполнить коммит приведет к ошибке, блокируя процесс разработки и не выполняя одну из ключевых проверок качества.

### Решение
Конфигурация pre-commit была обновлена для использования актуального скрипта `scripts/development/analyze_architecture.py`.

## 2. Неконсистентность в Управлении Зависимостями [RESOLVED]

### Проблема
В проекте одновременно используются устаревший и современный подходы к управлению зависимостями, что создает путаницу и риски рассинхронизации.

### Детали
- **Ожидание:** В соответствии с планом улучшений (`IMPROVEMENT_PLAN.md`) и руководствами, единственным источником правды для зависимостей должен быть файл `pyproject.toml` с использованием `[dependency-groups]`.
- **Реальность:** В проекте все еще присутствуют и активно используются файлы `requirements.txt` и `requirements-dev.txt`. Более того, скрипты автоматизации `setup.bat` и `start.bat` настроены на использование именно `requirements.txt`, полностью игнорируя `pyproject.toml`.
- **Влияние:** Это приводит к дублированию информации о зависимостях, усложняет их обновление и создает риск использования разных версий пакетов в разных окружениях.

### Решение
Устаревшие файлы `requirements.txt`, `requirements-dev.txt` и `requirements_minimal.txt` были удалены. Скрипты `setup.bat` и `start.bat` были обновлены для использования `pip install -e .[dev]`, что обеспечивает установку зависимостей непосредственно из `pyproject.toml`.

## 3. Рассинхронизация Файловой Системы и Отчетной Документации [RESOLVED]

### Проблема
Отчетная документация не всегда соответствует реальному состоянию проекта.

### Детали
- **Ожидание:** Все изменения, задокументированные в отчетах, должны быть отражены в файловой структуре.
- **Реальность:** Отчет `CLEANUP_REPORT.md` утверждает, что файл `requirements_minimal.txt` был удален. На самом деле, этот файл по-прежнему существует в проекте.
- **Влияние:** Подобные несоответствия подрывают доверие к документации и требуют ручной проверки для верификации состояния проекта.

### Решение
Файл `requirements_minimal.txt` был удален из проекта, что привело файловую систему в соответствие с документацией.

## 4. Несоответствие Структуры Тестов Стандартам [RESOLVED]

### Проблема
Организация тестовых файлов не полностью соответствует принятому в проекте стандарту "зеркальной" структуры.

### Детали
- **Ожидание:** Структура каталога `tests/` должна полностью повторять структуру `src/`, чтобы обеспечить легкую навигацию и сопоставление тестов с исходным кодом.
- **Реальность:** Модули, находящиеся в `src/code2markdown/domain/`, не имеют соответствующей директории `tests/code2markdown/domain/`. Их тесты (`test_domain_files.py`, `test_domain_filters.py` и др.) расположены на верхнем уровне каталога тестов.
- **Влияние:** Нарушение конвенции усложняет поиск соответствующих тестов для модулей доменной логики.

### Решение
Была создана директория `tests/code2markdown/domain/`, и все тесты доменных модулей были перемещены в нее, что привело структуру тестов в соответствие со стандартами проекта.

## Итоговое "Истинное Состояние" Проекта

Проект находится в продвинутой стадии зрелости с хорошо определенной архитектурой и внедренными практиками контроля качества. Все ключевые недостатки, мешавшие полной автоматизации и консистентности, были устранены:
1.  **Система контроля качества полностью исправна** - pre-commit хуки корректно настроены и работают.
2.  **Управление зависимостями унифицировано** - `pyproject.toml` является единственным источником правды для зависимостей.
3.  **Документация соответствует реальному состоянию** - файловая система и документация синхронизированы.
4.  **Структура тестов соответствует стандартам** - структура каталога `tests/` полностью повторяет структуру `src/`.

Все пункты были успешно исправлены в рамках первого спринта.